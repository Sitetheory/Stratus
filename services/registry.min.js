System.register(["lodash","stratus","stratus.services.model","stratus.services.collection","@stratusjs/core/conversion","@stratusjs/core/misc"],(function(t,e){"use strict";var o,i,a,r,n,c,l,s;e&&e.id;return{setters:[function(t){o=t},function(t){i=t},function(t){a=t},function(t){r=t},function(t){n=t},function(t){c=t}],execute:function(){l=(t,e,o,i)=>t=>{console.error("$interpolate not loaded:",t)},t("Registry",s=class{constructor(){this.fetch=this.fetch.bind(this)}fetch(t,e){return new Promise((a,r)=>{"string"==typeof t&&(t={target:t});const s=o.each({target:"data-target",targetSuffix:"data-target-suffix",id:"data-id",manifest:"data-manifest",decouple:"data-decouple",direct:"data-direct",api:"data-api",urlRoot:"data-url-root"},(e,o,i)=>{i[o]=t.attr?t.attr(e):t[o],c.isJSON(i[o])&&(i[o]=JSON.parse(i[o]))});s.api=n.sanitize(s.api);let u=0;const g=()=>{o.isNumber(u)&&u===o.size(s)&&a(this.build(s,e))};o.each(s,(t,o)=>{if(!t||"string"!=typeof t)return u++,void g();const a=l(t,!1,null,!0),r=a(e.$parent);if(void 0!==r)return s[o]=r,u++,void g();i.Environment.get("production")||console.log("poll attribute:",o),c.poll(()=>a(e.$parent),7500,250).then(t=>{i.Environment.get("production")||console.log("interpreted:",t),void 0!==t&&(s[o]=t,u++,g())}).catch(t=>{console.error(t)})})})}build(t,e){let o;if(t.target){if(t.target=c.ucfirst(t.target),t.manifest||t.id){i.Catalog[t.target]||(i.Catalog[t.target]={});const e=t.id||"manifest";if(t.decouple||!i.Catalog[t.target][e]){const r={target:t.target,manifest:t.manifest,stagger:!0};t.urlRoot&&(r.urlRoot=t.urlRoot),t.targetSuffix&&(r.targetSuffix=t.targetSuffix),o=new a.Model(r,{id:t.id}),t.decouple||(i.Catalog[t.target][e]=o)}else i.Catalog[t.target][e]&&(o=i.Catalog[t.target][e])}else{const e=t.direct?"Compendium":"Catalog";if(i[e][t.target]||(i[e][t.target]={}),t.decouple||!i[e][t.target].collection){const a={target:t.target,direct:!!t.direct};t.urlRoot&&(a.urlRoot=t.urlRoot),t.targetSuffix&&(a.targetSuffix=t.targetSuffix),o=new r.Collection(a),t.decouple||(i[e][t.target].collection=o)}else i[e][t.target].collection&&(o=i[e][t.target].collection)}t.api&&o.meta.set("api",c.isJSON(t.api)?JSON.parse(t.api):t.api),o.stagger&&"function"==typeof o.initialize&&o.initialize()}return"object"==typeof o&&null!==o&&(void 0!==e&&(e.data=o,o instanceof a.Model?(e.model=o,"function"==typeof e.$applyAsync&&e.model.on("change",()=>{e.$applyAsync()})):o instanceof r.Collection&&(e.collection=o)),o.pending||o.completed||o.fetch()),o}}),i.Services.Registry=["$provide",t=>{t.factory("Registry",["$interpolate","Collection","Model",(t,e,o)=>(l=t,new s)])}],i.Data.Registry=s}}}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjAiXSwibmFtZXMiOlsiU3lzdGVtIiwicmVnaXN0ZXIiLCJleHBvcnRzXzEiLCJjb250ZXh0XzEiLCJfIiwiU3RyYXR1cyIsInN0cmF0dXNfc2VydmljZXNfbW9kZWxfMSIsInN0cmF0dXNfc2VydmljZXNfY29sbGVjdGlvbl8xIiwiY29udmVyc2lvbl8xIiwibWlzY18xIiwiaW50ZXJwb2xhdGUiLCJSZWdpc3RyeSIsImlkIiwic2V0dGVycyIsIl8xIiwiU3RyYXR1c18xIiwic3RyYXR1c19zZXJ2aWNlc19tb2RlbF8xXzEiLCJzdHJhdHVzX3NlcnZpY2VzX2NvbGxlY3Rpb25fMV8xIiwiY29udmVyc2lvbl8xXzEiLCJtaXNjXzFfMSIsImV4ZWN1dGUiLCJ2YWx1ZSIsIm11c3RIYXZlRXhwcmVzc2lvbiIsInRydXN0ZWRDb250ZXh0IiwiYWxsT3JOb3RoaW5nIiwiZGF0YSIsImNvbnNvbGUiLCJlcnJvciIsIltvYmplY3QgT2JqZWN0XSIsInRoaXMiLCJmZXRjaCIsImJpbmQiLCIkZWxlbWVudCIsIiRzY29wZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwidGFyZ2V0Iiwib3B0aW9ucyIsImVhY2giLCJ0YXJnZXRTdWZmaXgiLCJtYW5pZmVzdCIsImRlY291cGxlIiwiZGlyZWN0IiwiYXBpIiwidXJsUm9vdCIsImtleSIsImxpc3QiLCJhdHRyIiwiaXNKU09OIiwiSlNPTiIsInBhcnNlIiwic2FuaXRpemUiLCJjb21wbGV0ZWQiLCJ2ZXJpZnkiLCJpc051bWJlciIsInNpemUiLCJidWlsZCIsImVsZW1lbnQiLCJpbnRlcnByZXRlciIsImluaXRpYWwiLCIkcGFyZW50IiwiRW52aXJvbm1lbnQiLCJnZXQiLCJsb2ciLCJwb2xsIiwidGhlbiIsImNhdGNoIiwibWVzc2FnZSIsInVjZmlyc3QiLCJDYXRhbG9nIiwibW9kZWxPcHRpb25zIiwic3RhZ2dlciIsIk1vZGVsIiwicmVnaXN0cnkiLCJjb2xsZWN0aW9uIiwiY29sbGVjdGlvbk9wdGlvbnMiLCJDb2xsZWN0aW9uIiwibWV0YSIsInNldCIsImluaXRpYWxpemUiLCJtb2RlbCIsIiRhcHBseUFzeW5jIiwib24iLCJwZW5kaW5nIiwiU2VydmljZXMiLCIkcHJvdmlkZSIsImZhY3RvcnkiLCIkaW50ZXJwb2xhdGUiLCJDIiwiTSIsIkRhdGEiXSwibWFwcGluZ3MiOiJBQUFBQSxPQUFPQyxTQUFTLENBQUMsU0FBVSxVQUFXLHlCQUEwQiw4QkFBK0IsNkJBQThCLHlCQUF5QixTQUFVQyxFQUFXQyxHQUN6SyxhQUVBLElBQUlDLEVBQUdDLEVBQVNDLEVBQTBCQyxFQUErQkMsRUFBY0MsRUFBUUMsRUFBYUMsRUFFekZSLEdBQWFBLEVBQVVTLEdBRTFDLE1BQU8sQ0FDTEMsUUFBUyxDQUFDLFNBQVVDLEdBQ2xCVixFQUFJVSxHQUNILFNBQVVDLEdBQ1hWLEVBQVVVLEdBQ1QsU0FBVUMsR0FDWFYsRUFBMkJVLEdBQzFCLFNBQVVDLEdBQ1hWLEVBQWdDVSxHQUMvQixTQUFVQyxHQUNYVixFQUFlVSxHQUNkLFNBQVVDLEdBQ1hWLEVBQVNVLElBRVhDLFFBQVMsV0FDUFYsRUFBYyxDQUFDVyxFQUFPQyxFQUFvQkMsRUFBZ0JDLElBQ2pEQyxJQUNMQyxRQUFRQyxNQUFNLDJCQUE0QkYsSUFpTTlDdkIsRUFBVSxXQTdMVlMsRUFBVyxNQUNUaUIsY0FDRUMsS0FBS0MsTUFBUUQsS0FBS0MsTUFBTUMsS0FBS0YsTUFHL0JELE1BQU1JLEVBQVVDLEdBQ2QsT0FBTyxJQUFJQyxRQUFRLENBQUNDLEVBQVNDLEtBQ0gsaUJBQWJKLElBQ1RBLEVBQVcsQ0FDVEssT0FBUUwsSUFJWixNQVdNTSxFQUFVbEMsRUFBRW1DLEtBWEgsQ0FDYkYsT0FBUSxjQUNSRyxhQUFjLHFCQUNkNUIsR0FBSSxVQUNKNkIsU0FBVSxnQkFDVkMsU0FBVSxnQkFDVkMsT0FBUSxjQUNSQyxJQUFLLFdBQ0xDLFFBQVMsaUJBR29CLENBQUN4QixFQUFPeUIsRUFBS0MsS0FDMUNBLEVBQUtELEdBQU9kLEVBQVNnQixLQUFPaEIsRUFBU2dCLEtBQUsz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