System.register(["lodash","stratus","stratus.services.model","stratus.services.collection","@stratusjs/core/conversion","@stratusjs/core/misc"],(function(t,e){"use strict";var o,i,a,r,n,c,l,s;e&&e.id;return{setters:[function(t){o=t},function(t){i=t},function(t){a=t},function(t){r=t},function(t){n=t},function(t){c=t}],execute:function(){l=(t,e,o,i)=>t=>{console.error("$interpolate not loaded:",t)},t("Registry",s=class{constructor(){this.fetch=this.fetch.bind(this)}fetch(t,e){return new Promise((a,r)=>{"string"==typeof t&&(t={target:t});const s=n.sanitize(o.each({target:"data-target",targetSuffix:"data-target-suffix",id:"data-id",manifest:"data-manifest",decouple:"data-decouple",direct:"data-direct",api:"data-api",urlRoot:"data-url-root"},(e,o,i)=>{i[o]=t.attr?t.attr(e):t[o]}));let u=0;const g=()=>{o.isNumber(u)&&u===o.size(s)&&a(this.build(s,e))};o.each(s,(t,o)=>{if(!t||"string"!=typeof t)return u++,void g();const a=l(t,!1,null,!0),r=a(e.$parent);if(void 0!==r)return s[o]=r,u++,void g();i.Environment.get("production")||console.log("poll attribute:",o),c.poll(()=>a(e.$parent),7500,250).then(t=>{i.Environment.get("production")||console.log("interpreted:",t),void 0!==t&&(s[o]=t,u++,g())}).catch(t=>{console.error(t)})})})}build(t,e){let o;if(t.target){if(t.target=c.ucfirst(t.target),t.manifest||t.id){i.Catalog[t.target]||(i.Catalog[t.target]={});const e=t.id||"manifest";if(t.decouple||!i.Catalog[t.target][e]){const r={target:t.target,manifest:t.manifest,stagger:!0};t.urlRoot&&(r.urlRoot=t.urlRoot),t.targetSuffix&&(r.targetSuffix=t.targetSuffix),o=new a.Model(r,{id:t.id}),t.decouple||(i.Catalog[t.target][e]=o)}else i.Catalog[t.target][e]&&(o=i.Catalog[t.target][e])}else{const e=t.direct?"Compendium":"Catalog";if(i[e][t.target]||(i[e][t.target]={}),t.decouple||!i[e][t.target].collection){const a={target:t.target,direct:!!t.direct};t.urlRoot&&(a.urlRoot=t.urlRoot),t.targetSuffix&&(a.targetSuffix=t.targetSuffix),o=new r.Collection(a),t.decouple||(i[e][t.target].collection=o)}else i[e][t.target].collection&&(o=i[e][t.target].collection)}t.api&&o.meta.set("api",c.isJSON(t.api)?JSON.parse(t.api):t.api),o.stagger&&"function"==typeof o.initialize&&o.initialize()}return"object"==typeof o&&null!==o&&(void 0!==e&&(e.data=o,o instanceof a.Model?(e.model=o,"function"==typeof e.$applyAsync&&e.model.on("change",()=>{e.$applyAsync()})):o instanceof r.Collection&&(e.collection=o)),o.pending||o.completed||o.fetch()),o}}),i.Services.Registry=["$provide",t=>{t.factory("Registry",["$interpolate","Collection","Model",(t,e,o)=>(l=t,new s)])}],i.Data.Registry=s}}}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjAiXSwibmFtZXMiOlsiU3lzdGVtIiwicmVnaXN0ZXIiLCJleHBvcnRzXzEiLCJjb250ZXh0XzEiLCJfIiwiU3RyYXR1cyIsInN0cmF0dXNfc2VydmljZXNfbW9kZWxfMSIsInN0cmF0dXNfc2VydmljZXNfY29sbGVjdGlvbl8xIiwiY29udmVyc2lvbl8xIiwibWlzY18xIiwiaW50ZXJwb2xhdGUiLCJSZWdpc3RyeSIsImlkIiwic2V0dGVycyIsIl8xIiwiU3RyYXR1c18xIiwic3RyYXR1c19zZXJ2aWNlc19tb2RlbF8xXzEiLCJzdHJhdHVzX3NlcnZpY2VzX2NvbGxlY3Rpb25fMV8xIiwiY29udmVyc2lvbl8xXzEiLCJtaXNjXzFfMSIsImV4ZWN1dGUiLCJ2YWx1ZSIsIm11c3RIYXZlRXhwcmVzc2lvbiIsInRydXN0ZWRDb250ZXh0IiwiYWxsT3JOb3RoaW5nIiwiZGF0YSIsImNvbnNvbGUiLCJlcnJvciIsIltvYmplY3QgT2JqZWN0XSIsInRoaXMiLCJmZXRjaCIsImJpbmQiLCIkZWxlbWVudCIsIiRzY29wZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwidGFyZ2V0Iiwib3B0aW9ucyIsInNhbml0aXplIiwiZWFjaCIsInRhcmdldFN1ZmZpeCIsIm1hbmlmZXN0IiwiZGVjb3VwbGUiLCJkaXJlY3QiLCJhcGkiLCJ1cmxSb290Iiwia2V5IiwibGlzdCIsImF0dHIiLCJjb21wbGV0ZWQiLCJ2ZXJpZnkiLCJpc051bWJlciIsInNpemUiLCJidWlsZCIsImVsZW1lbnQiLCJpbnRlcnByZXRlciIsImluaXRpYWwiLCIkcGFyZW50IiwiRW52aXJvbm1lbnQiLCJnZXQiLCJsb2ciLCJwb2xsIiwidGhlbiIsImNhdGNoIiwibWVzc2FnZSIsInVjZmlyc3QiLCJDYXRhbG9nIiwibW9kZWxPcHRpb25zIiwic3RhZ2dlciIsIk1vZGVsIiwicmVnaXN0cnkiLCJjb2xsZWN0aW9uIiwiY29sbGVjdGlvbk9wdGlvbnMiLCJDb2xsZWN0aW9uIiwibWV0YSIsInNldCIsImlzSlNPTiIsIkpTT04iLCJwYXJzZSIsImluaXRpYWxpemUiLCJtb2RlbCIsIiRhcHBseUFzeW5jIiwib24iLCJwZW5kaW5nIiwiU2VydmljZXMiLCIkcHJvdmlkZSIsImZhY3RvcnkiLCIkaW50ZXJwb2xhdGUiLCJEYXRhIl0sIm1hcHBpbmdzIjoiQUFBQUEsT0FBT0MsU0FBUyxDQUFDLFNBQVUsVUFBVyx5QkFBMEIsOEJBQStCLDZCQUE4Qix5QkFBeUIsU0FBVUMsRUFBV0MsR0FDekssYUFFQSxJQUFJQyxFQUFHQyxFQUFTQyxFQUEwQkMsRUFBK0JDLEVBQWNDLEVBQVFDLEVBQWFDLEVBRXpGUixHQUFhQSxFQUFVUyxHQUUxQyxNQUFPLENBQ0xDLFFBQVMsQ0FBQyxTQUFVQyxHQUNsQlYsRUFBSVUsR0FDSCxTQUFVQyxHQUNYVixFQUFVVSxHQUNULFNBQVVDLEdBQ1hWLEVBQTJCVSxHQUMxQixTQUFVQyxHQUNYVixFQUFnQ1UsR0FDL0IsU0FBVUMsR0FDWFYsRUFBZVUsR0FDZCxTQUFVQyxHQUNYVixFQUFTVSxJQUVYQyxRQUFTLFdBQ1BWLEVBQWMsQ0FBQ1csRUFBT0MsRUFBb0JDLEVBQWdCQyxJQUNqREMsSUFDTEMsUUFBUUMsTUFBTSwyQkFBNEJGLElBd0w5Q3ZCLEVBQVUsV0FwTFZTLEVBQVcsTUFDVGlCLGNBQ0VDLEtBQUtDLE1BQVFELEtBQUtDLE1BQU1DLEtBQUtGLE1BRy9CRCxNQUFNSSxFQUFVQyxHQUNkLE9BQU8sSUFBSUMsUUFBUSxDQUFDQyxFQUFTQyxLQUNILGlCQUFiSixJQUNUQSxFQUFXLENBQ1RLLE9BQVFMLElBSVosTUFVTU0sRUFBVTlCLEVBQWErQixTQUFTbkMsRUFBRW9DLEtBVnpCLENBQ2JILE9BQVEsY0FDUkksYUFBYyxxQkFDZDdCLEdBQUksVUFDSjhCLFNBQVUsZ0JBQ1ZDLFNBQVUsZ0JBQ1ZDLE9BQVEsY0FDUkMsSUFBSyxXQUNMQyxRQUFTLGlCQUUwQyxDQUFDekIsRUFBTzBCLEVBQUtDLEtBQ2hFQSxFQUFLRCxHQUFPZixFQUFTaUIsS0FBT2pCLEVBQVNp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