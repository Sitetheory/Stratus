System.register(["lodash","stratus","stratus.services.model","stratus.services.collection","@stratusjs/core/misc"],(function(t,e){"use strict";var o,a,i,r,n,l,c;e&&e.id;return{setters:[function(t){o=t},function(t){a=t},function(t){i=t},function(t){r=t},function(t){n=t}],execute:function(){l=(t,e,o,a)=>t=>{console.error("$interpolate not loaded:",t)},t("Registry",c=class{constructor(){this.fetch=this.fetch.bind(this)}fetch(t,e){return new Promise((i,r)=>{"string"==typeof t&&(t={target:t});const c=o.each({target:"data-target",targetSuffix:"data-target-suffix",id:"data-id",manifest:"data-manifest",decouple:"data-decouple",direct:"data-direct",api:"data-api",urlRoot:"data-url-root"},(e,o,a)=>{a[o]=t.attr?t.attr(e):t[o],n.isJSON(a[o])&&(a[o]=JSON.parse(a[o]))});let s=0;const g=()=>{o.isNumber(s)&&s===o.size(c)&&i(this.build(c,e))};o.each(c,(t,o)=>{if(!t||"string"!=typeof t)return s++,void g();const i=l(t,!1,null,!0),r=i(e.$parent);if(void 0!==r)return c[o]=r,s++,void g();a.Environment.get("production")||console.log("poll attribute:",o),n.poll(()=>i(e.$parent),7500,250).then(t=>{a.Environment.get("production")||console.log("interpreted:",t),void 0!==t&&(c[o]=t,s++,g())}).catch(t=>{console.error(t)})})})}build(t,e){let o;if(t.target){if(t.target=n.ucfirst(t.target),t.manifest||t.id){a.Catalog[t.target]||(a.Catalog[t.target]={});const e=t.id||"manifest";if(t.decouple||!a.Catalog[t.target][e]){const r={target:t.target,manifest:t.manifest,stagger:!0};t.urlRoot&&(r.urlRoot=t.urlRoot),t.targetSuffix&&(r.targetSuffix=t.targetSuffix),o=new i.Model(r,{id:t.id}),t.decouple||(a.Catalog[t.target][e]=o)}else a.Catalog[t.target][e]&&(o=a.Catalog[t.target][e])}else{const e=t.direct?"Compendium":"Catalog";if(a[e][t.target]||(a[e][t.target]={}),t.decouple||!a[e][t.target].collection){const i={target:t.target,direct:!!t.direct};t.urlRoot&&(i.urlRoot=t.urlRoot),t.targetSuffix&&(i.targetSuffix=t.targetSuffix),o=new r.Collection(i),t.decouple||(a[e][t.target].collection=o)}else a[e][t.target].collection&&(o=a[e][t.target].collection)}t.api&&o.meta.set("api",n.isJSON(t.api)?JSON.parse(t.api):t.api),o.stagger&&"function"==typeof o.initialize&&o.initialize()}return"object"==typeof o&&null!==o&&(void 0!==e&&(e.data=o,o instanceof i.Model?(e.model=o,"function"==typeof e.$applyAsync&&e.model.on("change",()=>{e.$applyAsync()})):o instanceof r.Collection&&(e.collection=o)),o.pending||o.completed||o.fetch()),o}}),a.Services.Registry=["$provide",t=>{t.factory("Registry",["$interpolate","Collection","Model",(t,e,o)=>(l=t,new c)])}],a.Data.Registry=c}}}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjAiXSwibmFtZXMiOlsiU3lzdGVtIiwicmVnaXN0ZXIiLCJleHBvcnRzXzEiLCJjb250ZXh0XzEiLCJfIiwiU3RyYXR1cyIsInN0cmF0dXNfc2VydmljZXNfbW9kZWxfMSIsInN0cmF0dXNfc2VydmljZXNfY29sbGVjdGlvbl8xIiwibWlzY18xIiwiaW50ZXJwb2xhdGUiLCJSZWdpc3RyeSIsImlkIiwic2V0dGVycyIsIl8xIiwiU3RyYXR1c18xIiwic3RyYXR1c19zZXJ2aWNlc19tb2RlbF8xXzEiLCJzdHJhdHVzX3NlcnZpY2VzX2NvbGxlY3Rpb25fMV8xIiwibWlzY18xXzEiLCJleGVjdXRlIiwidmFsdWUiLCJtdXN0SGF2ZUV4cHJlc3Npb24iLCJ0cnVzdGVkQ29udGV4dCIsImFsbE9yTm90aGluZyIsImRhdGEiLCJjb25zb2xlIiwiZXJyb3IiLCJbb2JqZWN0IE9iamVjdF0iLCJ0aGlzIiwiZmV0Y2giLCJiaW5kIiwiJGVsZW1lbnQiLCIkc2NvcGUiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInRhcmdldCIsIm9wdGlvbnMiLCJlYWNoIiwidGFyZ2V0U3VmZml4IiwibWFuaWZlc3QiLCJkZWNvdXBsZSIsImRpcmVjdCIsImFwaSIsInVybFJvb3QiLCJrZXkiLCJsaXN0IiwiYXR0ciIsImlzSlNPTiIsIkpTT04iLCJwYXJzZSIsImNvbXBsZXRlZCIsInZlcmlmeSIsImlzTnVtYmVyIiwic2l6ZSIsImJ1aWxkIiwiZWxlbWVudCIsImludGVycHJldGVyIiwiaW5pdGlhbCIsIiRwYXJlbnQiLCJFbnZpcm9ubWVudCIsImdldCIsImxvZyIsInBvbGwiLCJ0aGVuIiwiY2F0Y2giLCJtZXNzYWdlIiwidWNmaXJzdCIsIkNhdGFsb2ciLCJtb2RlbE9wdGlvbnMiLCJzdGFnZ2VyIiwiTW9kZWwiLCJyZWdpc3RyeSIsImNvbGxlY3Rpb24iLCJjb2xsZWN0aW9uT3B0aW9ucyIsIkNvbGxlY3Rpb24iLCJtZXRhIiwic2V0IiwiaW5pdGlhbGl6ZSIsIm1vZGVsIiwiJGFwcGx5QXN5bmMiLCJvbiIsInBlbmRpbmciLCJTZXJ2aWNlcyIsIiRwcm92aWRlIiwiZmFjdG9yeSIsIiRpbnRlcnBvbGF0ZSIsIkRhdGEiXSwibWFwcGluZ3MiOiJBQUFBQSxPQUFPQyxTQUFTLENBQUMsU0FBVSxVQUFXLHlCQUEwQiw4QkFBK0IseUJBQXlCLFNBQVVDLEVBQVdDLEdBQzNJLGFBRUEsSUFBSUMsRUFBR0MsRUFBU0MsRUFBMEJDLEVBQStCQyxFQUFRQyxFQUFhQyxFQUUzRVAsR0FBYUEsRUFBVVEsR0FFMUMsTUFBTyxDQUNMQyxRQUFTLENBQUMsU0FBVUMsR0FDbEJULEVBQUlTLEdBQ0gsU0FBVUMsR0FDWFQsRUFBVVMsR0FDVCxTQUFVQyxHQUNYVCxFQUEyQlMsR0FDMUIsU0FBVUMsR0FDWFQsRUFBZ0NTLEdBQy9CLFNBQVVDLEdBQ1hULEVBQVNTLElBRVhDLFFBQVMsV0FDUFQsRUFBYyxDQUFDVSxFQUFPQyxFQUFvQkMsRUFBZ0JDLElBQ2pEQyxJQUNMQyxRQUFRQyxNQUFNLDJCQUE0QkYsSUFnTTlDckIsRUFBVSxXQTVMVlEsRUFBVyxNQUNUZ0IsY0FDRUMsS0FBS0MsTUFBUUQsS0FBS0MsTUFBTUMsS0FBS0YsTUFHL0JELE1BQU1JLEVBQVVDLEdBQ2QsT0FBTyxJQUFJQyxRQUFRLENBQUNDLEVBQVNDLEtBQ0gsaUJBQWJKLElBQ1RBLEVBQVcsQ0FDVEssT0FBUUwsSUFJWixNQVdNTSxFQUFVaEMsRUFBRWlDLEtBWEgsQ0FDYkYsT0FBUSxjQUNSRyxhQUFjLHFCQUNkM0IsR0FBSSxVQUNKNEIsU0FBVSxnQkFDVkMsU0FBVSxnQkFDVkMsT0FBUSxjQUNSQyxJQUFLLFdBQ0xDLFFBQVMsaUJBR29CLENBQUN4QixFQUFPeUIsRUFBS0MsS0FDMUNBLEVBQUtELEdBQU9kLEVBQVNnQixLQUFPaEIsRUFBU2dCLEtBQUszQixHQUFTVyxFQUFTYyxHQUV2RHBDLEVBQU91QyxPQUFPRixFQUFLRCxNQUl4QkMsRUFBS0QsR0FBT0ksS0FBS0MsTUFBTUosRUFBS0QsT0FHOUIsSUFB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