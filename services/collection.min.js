System.register(["lodash","stratus","angular","angular-material","stratus.services.model","@stratus/core/misc"],(function(t,e){"use strict";var s,i,r,o,n,a,l,h;e&&e.id;return{setters:[function(t){s=t},function(t){i=t},function(t){r=t},function(t){},function(t){o=t},function(t){n=t}],execute:function(){a=()=>{console.error("$$http not loaded!")},l=()=>{console.error("$$mdToast not loaded!")},h=class extends i.Prototypes.EventManager{constructor(t){super(),this.throttle=s.throttle(this.fetch,1e3),this.name="Collection",this.target=null,this.direct=!1,this.infinite=!1,this.threshold=.5,this.qualifier="",this.decay=0,this.urlRoot="/Api",t&&"object"==typeof t&&r.extend(this,t),this.header=new i.Prototypes.Model,this.meta=new i.Prototypes.Model,this.model=o.Model,this.models=[],this.types=[],this.pending=!1,this.error=!1,this.completed=!1,this.filtering=!1,this.paginate=!1,this.target&&(this.urlRoot+="/"+n.ucfirst(this.target))}serialize(t,e){const s=this,i=[];return t=t||{},r.forEach(t,(t,o)=>{if(r.isObject(t))e&&(o=e+"["+o+"]"),i.push(s.serialize(t,o));else{let s="";e&&(s+=e+"["),s+=o,e&&(s+="]"),i.push(s+"="+t)}}),i.join("&")}url(){return this.urlRoot+(this.targetSuffix||"")}inject(t,e){if(!s.isArray(t))return;const i=this;-1===i.types.indexOf(e)&&i.types.push(e),t.forEach(t=>{i.models.push(new o.Model({collection:i,type:e||null},t))})}sync(t,e,o){const n=this;return n.pending=!0,n.completed=!1,new Promise((l,h)=>{o=o||{};const c={method:t=t||"GET",url:n.url(),headers:{}};r.isDefined(e)&&("GET"===t?r.isObject(e)&&Object.keys(e).length&&(c.url+=c.url.includes("?")?"&":"?",c.url+=n.serialize(e)):(c.headers["Content-Type"]="application/json",c.data=JSON.stringify(e))),Object.prototype.hasOwnProperty.call(o,"headers")&&"object"==typeof o.headers&&Object.keys(o.headers).forEach(t=>{c.headers[t]=o.headers[t]}),a(c).then(t=>{if(200===t.status&&r.isObject(t.data)){n.header.set(t.headers()||{}),n.meta.set(t.data.meta||{}),n.models=[];const e=t.data.payload||t.data;n.direct?n.models=e:s.isArray(e)?n.inject(e):s.isObject(e)?s.each(e,n.inject):console.error("malformed payload:",e),n.pending=!1,n.completed=!0,n.filtering=!1,n.paginate=!1,n.throttleTrigger("change"),l(n.models)}else{n.pending=!1,n.error=!0;const e=new i.Prototypes.Error;e.payload=s.isObject(t.data)?t.data:t,t.statusText&&"OK"!==t.statusText?e.message=t.statusText:s.isObject(t.data)?e.message="Unknown AngularCollection error!":e.message=`Invalid Payload: ${c.method} ${c.url}`,n.throttleTrigger("change"),h(e)}n.throttleTrigger("change")}).catch(t=>{throw console.error("XHR: "+c.method+" "+c.url),n.throttleTrigger("change"),h(t),t})})}fetch(t,e,s){return this.sync(t,e||this.meta.get("api"),s).catch(t=>{l.show(l.simple().textContent("Failure to Fetch!").toastClass("errorMessage").position("top right").hideDelay(3e3)),console.error("FETCH:",t)})}filter(t){return this.filtering=!0,this.meta.set("api.q",r.isDefined(t)?t:""),this.meta.set("api.p",1),this.fetch()}throttleFilter(t){this.meta.set("api.q",r.isDefined(t)?t:"");const e=this;return new Promise((t,s)=>{const r=e.throttle();i.Environment.get("production")||console.log("request:",r),r.then(e=>{i.Environment.get("production"),t(e)}).catch(s)})}page(t){this.paginate=!0,this.meta.set("api.p",t),this.fetch(),delete this.meta.get("api").p}toJSON(){return this.models.map(t=>t.toJSON())}add(t,e){if(!r.isObject(t))return;e&&"object"==typeof e||(e={});t=t instanceof o.Model?t:new o.Model({collection:this},t),this.models.push(t),this.throttleTrigger("change"),e.save&&t.save()}remove(t){return this.models.splice(this.models.indexOf(t),1),this.throttleTrigger("change"),this}find(t){return s.find(this.models,s.isFunction(t)?t:e=>e.get("id")===t)}pluck(t){return s.map(this.models,e=>e instanceof o.Model?e.pluck(t):null)}exists(t){return!!s.reduce(this.pluck(t)||[],(t,e)=>t||r.isDefined(e))}},t("Collection",h),i.Services.Collection=["$provide",t=>{t.factory("Collection",["$http","$mdToast",(t,e)=>(a=t,l=e,h)])}],i.Data.Collection=h}}}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjAiXSwibmFtZXMiOlsiU3lzdGVtIiwicmVnaXN0ZXIiLCJleHBvcnRzXzEiLCJjb250ZXh0XzEiLCJfIiwiU3RyYXR1cyIsImFuZ3VsYXIiLCJzdHJhdHVzX3NlcnZpY2VzX21vZGVsXzEiLCJtaXNjXzEiLCJodHRwIiwibWRUb2FzdCIsIkNvbGxlY3Rpb24iLCJpZCIsInNldHRlcnMiLCJfMSIsIlN0cmF0dXNfMSIsImFuZ3VsYXJfMSIsIl8yIiwic3RyYXR1c19zZXJ2aWNlc19tb2RlbF8xXzEiLCJtaXNjXzFfMSIsImV4ZWN1dGUiLCJjb25zb2xlIiwiZXJyb3IiLCJQcm90b3R5cGVzIiwiRXZlbnRNYW5hZ2VyIiwiW29iamVjdCBPYmplY3RdIiwib3B0aW9ucyIsInN1cGVyIiwidGhpcyIsInRocm90dGxlIiwiZmV0Y2giLCJuYW1lIiwidGFyZ2V0IiwiZGlyZWN0IiwiaW5maW5pdGUiLCJ0aHJlc2hvbGQiLCJxdWFsaWZpZXIiLCJkZWNheSIsInVybFJvb3QiLCJleHRlbmQiLCJoZWFkZXIiLCJNb2RlbCIsIm1ldGEiLCJtb2RlbCIsIm1vZGVscyIsInR5cGVzIiwicGVuZGluZyIsImNvbXBsZXRlZCIsImZpbHRlcmluZyIsInBhZ2luYXRlIiwidWNmaXJzdCIsIm9iaiIsImNoYWluIiwidGhhdCIsInN0ciIsImZvckVhY2giLCJ2YWx1ZSIsImtleSIsImlzT2JqZWN0IiwicHVzaCIsInNlcmlhbGl6ZSIsImVuY29kZWQiLCJqb2luIiwidGFyZ2V0U3VmZml4IiwiZGF0YSIsInR5cGUiLCJpc0FycmF5IiwiaW5kZXhPZiIsImNvbGxlY3Rpb24iLCJhY3Rpb24iLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInByb3RvdHlwZSIsIm1ldGhvZCIsInVybCIsImhlYWRlcnMiLCJpc0RlZmluZWQiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiaW5jbHVkZXMiLCJKU09OIiwic3RyaW5naWZ5IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaGVhZGVyS2V5IiwidGhlbiIsInJlc3BvbnNlIiwic3RhdHVzIiwic2V0IiwicmVjdiIsInBheWxvYWQiLCJpbmplY3QiLCJlYWNoIiwidGhyb3R0bGVUcmlnZ2VyIiwiRXJyb3IiLCJzdGF0dXNUZXh0IiwibWVzc2FnZSIsImNhdGNoIiwic3luYyIsImdldCIsInNob3ciLCJzaW1wbGUiLCJ0ZXh0Q29udGVudCIsInRvYXN0Q2xhc3MiLCJwb3NpdGlvbiIsImhpZGVEZWxheSIsInF1ZXJ5IiwicmVxdWVzdCIsIkVudmlyb25tZW50IiwibG9nIiwicGFnZSIsInAiLCJtYXAiLCJ0b0pTT04iLCJzYXZlIiwic3BsaWNlIiwicHJlZGljYXRlIiwiZmluZCIsImlzRnVuY3Rpb24iLCJhdHRyaWJ1dGUiLCJlbGVtZW50IiwicGx1Y2siLCJyZWR1Y2UiLCJtZW1vIiwiU2VydmljZXMiLCIkcHJvdmlkZSIsImZhY3RvcnkiLCIkaHR0cCIsIiRtZFRvYXN0IiwiRGF0YSJdLCJtYXBwaW5ncyI6IkFBQUFBLE9BQU9DLFNBQVMsQ0FBQyxTQUFVLFVBQVcsVUFBVyxtQkFBb0IseUJBQTBCLHVCQUF1QixTQUFVQyxFQUFXQyxHQUN6SSxhQUVBLElBQUlDLEVBQUdDLEVBQVNDLEVBQVNDLEVBQTBCQyxFQUFRQyxFQUFNQyxFQUFTQyxFQUV2RFIsR0FBYUEsRUFBVVMsR0FFMUMsTUFBTyxDQUNMQyxRQUFTLENBQUMsU0FBVUMsR0FDbEJWLEVBQUlVLEdBQ0gsU0FBVUMsR0FDWFYsRUFBVVUsR0FDVCxTQUFVQyxHQUNYVixFQUFVVSxHQUNULFNBQVVDLEtBQVEsU0FBVUMsR0FDN0JYLEVBQTJCVyxHQUMxQixTQUFVQyxHQUNYWCxFQUFTVyxJQUVYQyxRQUFTLFdBQ1BYLEVBQU8sS0FDTFksUUFBUUMsTUFBTSx1QkFHaEJaLEVBQVUsS0FDUlcsUUFBUUMsTUFBTSwwQkFHaEJYLEVBQWEsY0FBeUJOLEVBQVFrQixXQUFXQyxhQUN2REMsWUFBWUMsR0FDVkMsUUFDQUMsS0FBS0MsU0FBV3pCLEVBQUV5QixTQUFTRCxLQUFLRSxN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