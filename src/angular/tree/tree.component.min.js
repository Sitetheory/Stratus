System.register(["@angular/core","@angular/forms","@angular/cdk/drag-drop","rxjs","@angular/platform-browser","@angular/material/icon","stratus","lodash"],function(e,t){"use strict";var n,r,s,o,i,c,a,l,u,d,h=this&&this.__decorate||function(e,t,n,r){var s,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(s=e[c])&&(i=(o<3?s(i):o>3?s(t,n,i):s(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i},f=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},g=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(s,o){function i(e){try{a(r.next(e))}catch(e){o(e)}}function c(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){e.done?s(e.value):new n(function(t){t(e.value)}).then(i,c)}a((r=r.apply(e,t||[])).next())})};t&&t.id;return{setters:[function(e){n=e},function(e){r=e},function(e){s=e},function(e){o=e},function(e){i=e},function(e){c=e},function(e){a=e},function(e){l=e}],execute:function(){u="/assets/1/0/bundles/sitetheorystratus/stratus/src/angular","@stratus/angular","tree",d=class{constructor(e,t,n){this.ref=n,this.title="tree-dnd",this.selectCtrl=new r.FormControl,this.registry=new a.Data.Registry,this.onChange=new o.Subject,this.uid=l.uniqueId("s2_tree_component_"),a.Instances[this.uid]=this;const s=this;this._=l,this.sanitizer=t,e.addSvgIcon("delete",t.bypassSecurityTrustResourceUrl("/Api/Resource?path=@SitetheoryCoreBundle:images/icons/actionButtons/delete.svg")),a.Internals.CssLoader(`${u}/tree/tree.component.css`),this.fetchModel().then(function(e){e.on?(n.detach(),e.on("change",function(){s.selectedModelDefer(s.subscriber),n.detectChanges()})):console.warn("Unable to bind data from Registry!")}),this.selectedModels=new o.Observable(e=>this.selectedModelDefer(e))}drop(e){const t=this.selectedModelRef();if(!t||!t.length)return;s.moveItemInArray(t,e.previousIndex,e.currentIndex);let n=0;l.each(t,e=>e.priority=n++),this.model.trigger("change")}remove(e){const t=this.selectedModelRef();if(!t||!t.length)return;const n=t.indexOf(e);-1!==n&&(t.splice(n,1),this.model.trigger("change"))}fetchModel(){return g(this,void 0,void 0,function*(){return this.fetched||(this.fetched=this.registry.fetch(a.Select("#content-menu-primary"),this)),this.fetched})}selectedModelDefer(e){this.subscriber=e;const t=this.selectedModelRef();t&&t.length?e.next(t):setTimeout(()=>this.selectedModelDefer(e),500)}selectedModelRef(){if(!this.model)return[];const e=l.get(this.model,"data.version.text");return e&&l.isArray(e)?e:[]}},d=h([n.Component({selector:"s2-tree-component",templateUrl:`${u}/tree/tree.component.html`}),f("design:paramtypes",[c.MatIconRegistry,i.DomSanitizer,n.ChangeDetectorRef])],d),e("TreeComponent",d)}}});