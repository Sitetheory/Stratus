<!-- show progress while initializing -->
<!--
<mat-progress-bar mode="indeterminate" *ngIf="!isStyled || !isInitialized"></mat-progress-bar>
-->

<div class="tree-node-content"
     [class.display-none]="parent && !isExpanded(parent)"
     [attr.data-id]="node.id"
     [attr.id]="'node-'+node.id">

    <!-- use a disabled button to provide padding for tree leaf -->
    <button mat-icon-button
            *ngIf="!hasChild(node)"
            disabled></button>

    <!-- use a regular button to control expandable nodes -->
    <button mat-icon-button
            *ngIf="hasChild(node)"
            (click)="toggleExpandedClick(node)"
            (dblclick)="toggleExpandedDblClick(node)"
            [attr.aria-label]="'toggle ' + getName(node)">
        <mat-icon class="mat-icon-rtl-mirror">
            {{isExpanded(node) ? 'expand_more' : 'chevron_right'}}
        </mat-icon>
    </button>

    <!-- clickable name is also the drag handle -->
    <!-- cdkDragHandle -->
    <span cdkDragPlaceholder
          class="node-name"
          [attr.data-id]="node.id"
          [attr.id]="'node-'+node.id"
          [class.visibility-off]="node.model.get('status') === 0"
          [innerHTML]="getName(node)"
          (click)="openDialogClick(node)"
          (dblclick)="openDialogDblClick(node)"></span>

    <!-- drag preview is all that is viewable when dragging -->
<!--    <span cdkDragPreview-->
<!--          [innerHTML]="getDragPreview(node)"-->
<!--          class="tree-node-drag-preview"></span>-->

    <!-- drag placeholder is displayed in place of the element being dragged -->
<!--    <span cdkDragPlaceholder-->
<!--          [innerHTML]="getDragPreview(node)"-->
<!--          class="tree-node-drag-placeholder"></span>-->

    <!-- Content Type Icon -->
    <mat-icon class="type-icon"
              aria-hidden="true"
              *ngIf="node.model.get('content.contentType.iconResourcePath')"
              [svgIcon]="getSvg('/assets/1/0/bundles/' + node.model.get('content.contentType.iconResourcePath')) | async">
    </mat-icon>

    <!-- Route Display -->
    <small [class.route-none]="!node.model.get('route')"
           [class.type-none]="!node.model.get('content.contentType.iconResourcePath')">
        {{node.model.get('route') || 'No route set!'}}
    </small>

    <!-- create drop list -->
    <!-- FIXME: enabling [cdkDropListSortingDisabled]="true" allows parent drops with ease, but no sorting information -->
    <div cdkDropList
         [id]="tree.uid + '_node_' + node.id + '_drop_list'"
         [cdkDropListConnectedTo]="tree.dropLists"
         [cdkDropListData]="node"
         [cdkDropListDisabled]="false"
         (cdkDropListDropped)="tree.onDragDrop($event)"
         [cdkDropListSortingDisabled]="tree.cdkDropListSortingDisabled"
         class="tree-node-drop-list">
        <!-- Legacy child expand / collapse:
        <div *ngIf="hasChild(node)"
             [class.display-none]="!isExpanded(node)">
        -->
        <!-- display children -->
        <sa-tree-node cdkDrag
                      *ngFor="let child of node.children"
                      (cdkDragMoved)="tree.onDragMove($event)"
                      [cdkDragData]="child"
                      [tree]="tree"
                      [parent]="node"
                      [node]="child"
                      class="tree-node"></sa-tree-node>
    </div>
</div>
