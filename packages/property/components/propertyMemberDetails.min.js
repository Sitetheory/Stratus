!function(e,t){"function"==typeof define&&define.amd?define(["stratus","lodash","angular","moment","angular-sanitize","stratus.services.propertyLoopback","stratus.filters.math","stratus.filters.moment"],t):t(e.Stratus,e._,e.angular,e.moment)}(this,(function(e,t,o,i){const r=e.Environment.get("production")?".min":"";e.Components.PropertyMemberDetails={bindings:{elementId:"@",urlLoad:"@",pageTitle:"@",service:"@",memberKey:"@",memberStateLicense:"@",images:"@",openhouses:"@",googleApiKey:"@",options:"@",defaultListOptions:"@"},controller:["$scope","$attrs","$sce","$location","Model","propertyLoopback",function(o,n,s,m,a,l){const c=this;c.uid=t.uniqueId("property_member_details_"),e.Instances[c.uid]=o,o.elementId=n.elementId||c.uid,e.Internals.CssLoader(e.BaseUrl+"content/property/stratus/components/propertyMemberDetails"+r+".css"),c.$onInit=function(){o.options=n.options&&t.isJSON(n.options)?JSON.parse(n.options):{},o.options.urlLoad=!n.urlLoad||!t.isJSON(n.urlLoad)||JSON.parse(n.urlLoad),o.options.pageTitle=!(!n.pageTitle||!t.isJSON(n.pageTitle))&&JSON.parse(n.pageTitle),o.options.service=n.service?n.service:null,o.options.MemberKey=n.memberKey?n.memberKey:null,o.options.MemberStateLicense=n.memberStateLicense?n.memberStateLicense:null,o.options.images=n.images&&t.isJSON(n.images)?JSON.parse(n.images):{fields:["Order","MediaURL","LongDescription"]},o.googleApiKey=n.googleApiKey||null,o.defaultListOptions=n.defaultListOptions&&t.isJSON(n.defaultListOptions)?JSON.parse(n.defaultListOptions):{},o.memberMerged={},o.memberCombined={},l.registerListInstance(o.elementId,o,"MemberDetails"),console.log("options",o.options,n),o.fetchMember()},o.$watch("collection.models",(async function(e){o.devLog("Loaded Member Data:",e),await o.individualMember(),o.options.pageTitle&&(Object.prototype.hasOwnProperty.call(o.memberMerged,"MemberFullName")||Object.prototype.hasOwnProperty.call(o.memberMerged,"MemberFirstName"))&&l.setPageTitle(o.memberMerged.MemberFullName||o.memberMerged.MemberFirstName+" "+o.memberMerged.MemberLastName)})),o.getUid=function(){return c.uid},o.fetchMember=function(){const e={listName:"MemberDetailsList",service:[o.options.service],where:{}};o.options.MemberKey?e.where.MemberKey=o.options.MemberKey:o.options.MemberStateLicense&&(e.where.MemberStateLicense=o.options.MemberStateLicense),o.options.images&&(e.images=o.options.images),e.service&&(e.where.MemberKey||e.where.MemberStateLicense)?l.fetchMembers(o,"collection",e,!0):console.error("No Service Id or Member Key/License is fetch from")},o.individualMember=function(){return new Promise((function(e){if(o.collection&&o.collection.completed&&o.collection.models.length>0){o.memberMerged={},[].concat(o.collection.models).reverse().forEach((function(e){t.extend(o.memberMerged,e)})),o.memberCombined={},o.collection.models.map((function(e){Object.keys(e).forEach((function(i){(!t.isArray(e[i])||t.isArray(e[i])&&e[i].length>0)&&(o.memberCombined[i]=o.memberCombined[i]||[],o.memberCombined[i].includes(e[i])||o.memberCombined[i].push(e[i]))}))}))}e()}))},o.getMLSName=function(){return l.getMLSVariables(o.model.data._ServiceId).name},o.getMLSDisclaimer=function(e){let t=l.getMLSVariables(o.collection.models[0]._ServiceId).disclaimer;return o.collection.models[0].ModificationTimestamp&&(t=`Member last updated ${i(o.collection.models[0].ModificationTimestamp).format("M/D/YY HH:mm a")}. ${t}`),o.collection.models[0].fetchDate&&(t=`Last checked ${i(o.model.meta.data.fetchDate).format("M/D/YY")}. ${t}`),e?s.trustAsHtml(t):t},o.remove=function(){},o.devLog=function(t,o){e.Environment.get("production")||console.log(t,o)}}],templateUrl:e.BaseUrl+"content/property/stratus/components/propertyMemberDetails"+r+".html"}}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjAiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJkZWZpbmUiLCJhbWQiLCJTdHJhdHVzIiwiXyIsImFuZ3VsYXIiLCJtb21lbnQiLCJ0aGlzIiwibWluIiwiRW52aXJvbm1lbnQiLCJnZXQiLCJDb21wb25lbnRzIiwiUHJvcGVydHlNZW1iZXJEZXRhaWxzIiwiYmluZGluZ3MiLCJlbGVtZW50SWQiLCJ1cmxMb2FkIiwicGFnZVRpdGxlIiwic2VydmljZSIsIm1lbWJlcktleSIsIm1lbWJlclN0YXRlTGljZW5zZSIsImltYWdlcyIsIm9wZW5ob3VzZXMiLCJnb29nbGVBcGlLZXkiLCJvcHRpb25zIiwiZGVmYXVsdExpc3RPcHRpb25zIiwiY29udHJvbGxlciIsIiRzY29wZSIsIiRhdHRycyIsIiRzY2UiLCIkbG9jYXRpb24iLCJNb2RlbCIsInByb3BlcnR5TG9vcGJhY2siLCIkY3RybCIsInVpZCIsInVuaXF1ZUlkIiwiSW5zdGFuY2VzIiwiSW50ZXJuYWxzIiwiQ3NzTG9hZGVyIiwiQmFzZVVybCIsIiRvbkluaXQiLCJpc0pTT04iLCJKU09OIiwicGFyc2UiLCJNZW1iZXJLZXkiLCJNZW1iZXJTdGF0ZUxpY2Vuc2UiLCJmaWVsZHMiLCJtZW1iZXJNZXJnZWQiLCJtZW1iZXJDb21iaW5lZCIsInJlZ2lzdGVyTGlzdEluc3RhbmNlIiwiY29uc29sZSIsImxvZyIsImZldGNoTWVtYmVyIiwiJHdhdGNoIiwiYXN5bmMiLCJtb2RlbHMiLCJkZXZMb2ciLCJpbmRpdmlkdWFsTWVtYmVyIiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwic2V0UGFnZVRpdGxlIiwiTWVtYmVyRnVsbE5hbWUiLCJNZW1iZXJGaXJzdE5hbWUiLCJNZW1iZXJMYXN0TmFtZSIsImdldFVpZCIsIm1lbWJlclF1ZXJ5IiwibGlzdE5hbWUiLCJ3aGVyZSIsImZldGNoTWVtYmVycyIsImVycm9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJjb2xsZWN0aW9uIiwiY29tcGxldGVkIiwibGVuZ3RoIiwiY29uY2F0IiwicmV2ZXJzZSIsImZvckVhY2giLCJhZ2VudCIsImV4dGVuZCIsIm1hcCIsImtleXMiLCJrZXkiLCJpc0FycmF5IiwiaW5jbHVkZXMiLCJwdXNoIiwiZ2V0TUxTTmFtZSIsImdldE1MU1ZhcmlhYmxlcyIsIm1vZGVsIiwiZGF0YSIsIl9TZXJ2aWNlSWQiLCJuYW1lIiwiZ2V0TUxTRGlzY2xhaW1lciIsImh0bWwiLCJkaXNjbGFpbWVyIiwiTW9kaWZpY2F0aW9uVGltZXN0YW1wIiwiZm9ybWF0IiwiZmV0Y2hEYXRlIiwibWV0YSIsInRydXN0QXNIdG1sIiwicmVtb3ZlIiwiaXRlbTEiLCJpdGVtMiIsInRlbXBsYXRlVXJsIl0sIm1hcHBpbmdzIjoiQ0E2QkEsU0FBV0EsRUFBTUMsR0FDTyxtQkFBWEMsUUFBeUJBLE9BQU9DLElBQ3pDRCxPQUFPLENBQUMsVUFDUixTQUFVLFVBQVcsU0FBVSxtQkFBb0Isb0NBQXFDLHVCQUF3QiwwQkFBMkJELEdBRTNJQSxFQUFRRCxFQUFLSSxRQUFTSixFQUFLSyxFQUFHTCxFQUFLTSxRQUFTTixFQUFLTyxRQUxyRCxDQU9HQyxNQUFNLFNBQVVKLEVBQVNDLEVBQUdDLEVBQVNDLEdBQ3RDLE1BQU1FLEVBQU1MLEVBQVFNLFlBQVlDLElBQUksY0FBZ0IsT0FBUyxHQUM3RFAsRUFBUVEsV0FBV0Msc0JBQXdCLENBQ3pDQyxTQUFVLENBQ1JDLFVBQVcsSUFDWEMsUUFBUyxJQUNUQyxVQUFXLElBQ1hDLFFBQVMsSUFDVEMsVUFBVyxJQUNYQyxtQkFBb0IsSUFDcEJDLE9BQVEsSUFDUkMsV0FBWSxJQUNaQyxhQUFjLElBQ2RDLFFBQVMsSUFDVEMsbUJBQW9CLEtBRXRCQyxXQUFZLENBQUMsU0FBVSxTQUFVLE9BQVEsWUFBYSxRQUFTLG1CQUFvQixTQUFVQyxFQUFRQyxFQUFRQyxFQUFNQyxFQUFXQyxFQUFPQyxHQUVuSSxNQUFNQyxFQUFRekIsS0FDZHlCLEVBQU1DLElBQU03QixFQUFFOEIsU0FBUyw0QkFDdkIvQixF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