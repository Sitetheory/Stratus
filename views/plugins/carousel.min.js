//     Stratus.Views.Plugins.Carousel.js 1.0
//     Copyright (c) 2016 by Sitetheory, All Rights Reserved
//
//     All information contained herein is, and remains the
//     property of Sitetheory and its suppliers, if any.
//     The intellectual and technical concepts contained herein
//     are proprietary to Sitetheory and its suppliers and may be
//     covered by U.S. and Foreign Patents, patents in process,
//     and are protected by trade secret or copyright law.
//     Dissemination of this information or reproduction of this
//     material is strictly forbidden unless prior written
//     permission is obtained from Sitetheory.
//
//     For full details and documentation:
//     http://docs.sitetheory.io
!function(e,t){"function"==typeof define&&define.amd?define(["stratus","jquery","underscore","bootstrap","stratus.views.plugins.base"],t):t(e.Stratus,e.$,e._)}(this,function(e,t,a){e.Views.Plugins.Carousel=e.Views.Plugins.Base.extend({initialize:function(t){this.prepare(t);var a=this.$el.find(".carousel-inner > .item");e.Client.mobile&&this.$el.data("groupmobile")?this.batchItems(this.$el.data("groupmobile"),a):this.$el.data("group")&&this.batchItems(this.$el.data("group"),a),this.$el.carousel({interval:this.$el.data("interval")?this.$el.data("interval"):5e3,pause:this.$el.data("pause")?this.$el.data("pause"):"hover",wrap:!this.$el.data("wrap")||this.$el.data("wrap"),keyboard:!this.$el.data("keyboard")||this.$el.data("keyboard")}),this.$el.on("slid.bs.carousel",function(){e.Environment.get("viewPortChange")===!1&&e.Environment.set("viewPortChange",!0)})},batchItems:function(e,i){e=e<=0?1:e;var s=Math.round(12/e),n=this.$el.data("colminsize")?this.$el.data("colminsize"):"xs",l=this.$el.find(".carousel-inner");l.empty();var r=!1;a.each(i,function(i,d){var h,o=0,c=l.children(".item");c.length>0&&(h=t(a.last(c)),o=h.children(".nestedItem").length),(!o||o>=e)&&(h=t('<div class="item"></div>'),l.append(h)),t(i).removeClass("item").addClass("nestedItem col-"+n+"-"+s),h.append(t(i)),t(i).hasClass("active")&&(r=!0,h.addClass("active"))}.bind(this)),r||t(a.first(this.$el.find(".carousel-inner .item"))).addClass("active");var d=t("[data-lazysrc]");d.length>0&&a.each(d,function(e){t(e).attr("data-src",t(e).attr("data-lazysrc")).attr("data-lazysrc",null)})}})});