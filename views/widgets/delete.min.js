//     Stratus.Views.Delete.js 1.0
//     Copyright (c) 2016 by Sitetheory, All Rights Reserved
//
//     All information contained herein is, and remains the
//     property of Sitetheory and its suppliers, if any.
//     The intellectual and technical concepts contained herein
//     are proprietary to Sitetheory and its suppliers and may be
//     covered by U.S. and Foreign Patents, patents in process,
//     and are protected by trade secret or copyright law.
//     Dissemination of this information or reproduction of this
//     material is strictly forbidden unless prior written
//     permission is obtained from Sitetheory.
//
//     For full details and documentation:
//     http://docs.sitetheory.io
!function(t,e){"function"==typeof define&&define.amd?define(["stratus","jquery","underscore","stratus.views.widgets.base"],e):e(t.Stratus,t.$,t._)}(this,function(t,e,s){t.Views.Widgets.Delete=t.Views.Widgets.Base.extend({template:s.template('{% if (options.icon !== false) { %}<span id="{{ elementId }}" class="{{ options.classBtn }}">{% if (options.icon === null) { %}<svg viewBox="0 0 50 50" version="1.1"xmlns:xlink="http://www.w3.org/1999/xlink"><defs><linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="linearGradient-{{ elementId }}"><stop class="stop1" stop-color="#666666" offset="0%"></stop><stop class="stop2" stop-color="#666666" offset="100%"></stop></linearGradient></defs><g id="{{ elementId }}" class="actionButton" fill="url(#linearGradient-{{ elementId }})"><path d="M9.98721875,42 C9.98721875,44.209 11.736676,45.99 13.8951228,45.99 L36.092096,45.99 C38.2564134,45.99 40,44.204 40,42 L40,17 L10,17 L9.98721875,42 Z M16.9936094,23.904 L18.9872188,23.904 L18.9872188,40.0891113 L16.9936094,40.0891113 L16.9936094,23.904 Z M23.9286042,23.904 L25.9872188,23.904 L25.9872188,40.0891113 L23.9286042,40.0891113 L23.9286042,23.904 Z M30.9936094,23.904 L32.9872188,23.904 L32.9872188,40.0891113 L30.9936094,40.0891113 L30.9936094,23.904 Z" id="trashBase"></path><path d="M29.2875402,9.05695537 L29.2875402,5 L20.7124598,5 L20.7124598,9.05695537 L13.20584,9.05695537 C11.4407276,9.05695537 9.99360938,10.4185299 9.99360938,12.0985149 L9.98721875,15 L40,15 L40.0063906,12.0985149 C40.0063906,10.4222324 38.5680784,9.05695537 36.79416,9.05695537 L29.2875402,9.05695537 Z M22.8562299,7.02801488 L27.1437701,7.02801488 L27.1437701,9.05602976 L22.8562299,9.05602976 L22.8562299,7.02801488 Z" id="trashLid"></path></g></svg>{% } else { %}{{ options.icon }}{% } %}</span>{% } %}{% if (options.textOn !== false) { %}<span class="{{ options.classOn }}">{{ options.textOn }}</span><span class="{{ options.classOff }}">{{ options.textOff }}</span>{% } %}'),events:{click:"saveAction"},options:{"private":{forceType:"model"},"public":{editable:!1,icon:null,textOn:"Delete",textOff:"Undelete",textDeleteConfirm:"Are you sure you want to delete this?",classBtn:"btnIcon",classOn:"btnText smallLabel textOn",classOff:"btnText smallLabel textOff",destroy:!1,redirect:null,collectionMin:null}},onRegister:function(){return this.options.collectionMin&&s.has(this.model,"collection")&&"function"!=typeof this.model.collection&&(this.model.collection.on("add",this.checkMin,this),this.model.collection.on("remove",this.checkMin,this),this.checkMin()),this.model.on("change",this.scopeChanged,this),this.model.on("success",this.successAction,this),!0},checkMin:function(){this.disabled=!1,this.model.collection.length<=this.options.collectionMin?(this.disabled=!0,this.$el.addClass("hidden")):this.$el.removeClass("hidden")},saveAction:function(e){return this.disabled?this:(this.options.destroy?this.model.destroy():this.toggleValue()<0&&this.options.textDeleteConfirm?(this.confirm=this.confirm||new t.Prototypes.Bootbox({message:this.options.textDeleteConfirm,handler:function(t){t&&this.model.save({status:this.toggleValue()})}.bind(this)}),t.Events.trigger("confirm",this.confirm)):this.model.save({status:this.toggleValue()}),this)},scopeChanged:function(t){var e=this.model.get("status")===-1;this.$el.toggleClass("deleted",e),this.$el.toggleClass("on",!e),this.$el.toggleClass("off",e)},successAction:function(t,e,s){this.model.get("status")===-1&&(this.options.redirect?window.location.href=this.options.redirect:this.options.destroy)},toggleValue:function(){return this.model.get("status")===-1?0:-1}})});