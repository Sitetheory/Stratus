!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","angular","angular-material","stratus.services.collection"],factory):factory(root.Stratus,root._,root.angular)}(this,function(Stratus,_,angular){const min=Stratus.Environment.get("production")?".min":"";Stratus.Components.Permission={bindings:{elementId:"@",ngModel:"=",user:"@",role:"@",bundle:"@",type:"@",target:"@",sentinel:"@"},controller:function($scope,$attrs,$log,Collection){this.uid=_.uniqueId(_.camelToSnake("permission")+"_"),Stratus.Instances[this.uid]=$scope,$scope.elementId=$attrs.elementId||this.uid,$scope.initialized=!1,$scope.collection=null,$scope.$watch("$ctrl.ngModel",function(data){data instanceof Collection&&($scope.collection=data)}),$scope.$watch("collection.completed",function(completed){completed&&!$scope.collection.models.length&&$scope.collection.add({})}),$scope.sentinel={},$scope.$watch("collection.models.length",function(){_.each($scope.collection?$scope.collection.models:[],function(model){if(model.exists("id")&&model.exists("sentinel")){let sentinel=new Stratus.Prototypes.Sentinel;sentinel.permissions(model.get("permissions")),$scope.sentinel[model.getIdentifier()]=sentinel}})}),$scope.$watch("sentinel",function(sentinels){angular.isObject(sentinels)&&_.each(sentinels,function(sentinel,id){angular.isObject($scope.collection)&&angular.isObject(sentinel)&&_.each($scope.collection.models||[],function(model){angular.isObject(model)&&model.getIdentifier()===parseInt(id)&&model.set("permissions",sentinel.permissions())})})},!0)},templateUrl:Stratus.BaseUrl+Stratus.BundlePath+"components/permission"+min+".html"}});