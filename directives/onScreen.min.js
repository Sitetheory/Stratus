!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","jquery","angular"],factory):factory(root.Stratus,root._,root.$,root.angular)}(this,function(Stratus,_,$,angular){Stratus.Directives.OnScreen=function($parse,$interpolate){return{restrict:"A",scope:{onScreen:"@onScreen",stratusOnScreen:"@stratusOnScreen",offScreen:"@offScreen",spy:"@spy",target:"@target",event:"@event",offset:"@offset",reset:"@reset"},link:function(scope,element,attrs){element.uid=_.uniqueId("on_screen_"),Stratus.Instances[element.uid]=scope,scope.elementId=attrs.elementId||element.uid;const event=attrs.event?attrs.event.split(" "):[],target=attrs.target?$(attrs.target):element;let spy=attrs.spy?$(attrs.spy):element;spy.length||(spy=element);const offset=_.hydrate(attrs.offset||0),reset=attrs.reset||0;Stratus.Internals.OnScroll(),Stratus.Environment.on("change:viewPortChange",function(model){-1!==event.indexOf("reset")&&(reset>0&&$(element).offset().top<=reset||$(window).scrollTop()<=0)&&target.removeClass("onScreen offScreen ascend descend")}),Stratus.Environment.on("change:lastScroll",function(model){let lastScroll=Stratus.Environment.get("lastScroll");"down"===lastScroll&&(target.hasClass("descend")||target.addClass("descend"),target.hasClass("ascend")&&target.removeClass("ascend")),"up"===lastScroll&&(target.hasClass("ascend")||target.addClass("ascend"),target.hasClass("descend")&&target.removeClass("descend")),Stratus.Internals.IsOnScreen(spy,offset)?(target.hasClass("onScreen")||target.addClass("onScreen onScreenInit"),target.hasClass("offScreen")&&target.removeClass("offScreen"),!attrs.onScreen||"function"!=typeof attrs.onScreen||attrs.onScreen()):(target.hasClass("onScreen")&&target.removeClass("onScreen"),target.hasClass("offScreen")||target.addClass("offScreen"),!attrs.offScreen||"function"!=typeof attrs.offScreen||attrs.offScreen())})}}}});